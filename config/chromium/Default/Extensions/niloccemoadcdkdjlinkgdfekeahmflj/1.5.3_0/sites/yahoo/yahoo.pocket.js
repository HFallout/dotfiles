(function(){function i(){r||(r=setInterval(function(){n()},1500))}if(isSafari()&&window.top!=window)return;var e={};e.buttons=[{text:"pocket",successText:"saved to pocket",container:".content.cf",className:"side-button pocket-yahoo-button",selector:".pocket-yahoo-button",data:function(e){var t=$(e).attr("data-url").trim();t=unescape(t);var n=$(e).find("a")[0],r=$(n).text().trim();return{title:r,url:t}}}];var t=function(e){var t=document.createElement("a");return t.setAttribute("class",e.className),t.setAttribute("href","#"),t.style.cssText="top:31px;display:none;",t},n=function(){var n,r=e.buttons.length;for(n=0;n<r;n++){var i=e.buttons[n];$(i.container).each(function(){var e=$(this);if($(e).hasClass("pocket-inserted"))return;$(e).addClass("pocket-inserted");var n=t(i);$($(e).find(".side-button")[1]).css("top","56px"),$(n).insertAfter($(e).find(".side-button")[0]),$(e).hover(function(){$(n).show()},function(){$(n).hide()}),$(e).is(":hover")&&$(n).show();var r=i.data;$(n).click(function(n){var i=r(e),s={id:"yahoo",action:"addURL",url:i.url,title:i.title};return sendMessage(s,function(e){e.status==="success",window.thePKT_BM.handleMessageResponse(e)}),n.preventDefault(),!1})})}},r;addMessageListener(function(e,t,n){if(e.action==="settingChanged"&&e.key==="yahoo")if(e.value==="true"||e.value===!0)i();else if(e.value==="false"||e.value===!1)clearInterval(r),r=undefined}),sendMessage({action:"getSetting",key:"yahoo"},function(e){(e.value==="true"||e.value===!0)&&i()})})();